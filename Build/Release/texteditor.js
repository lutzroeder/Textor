Array.prototype.remove=function(d){for(var f=this.length;f--;)this[f]==d&&this.splice(f,1)};var Textor;
(function(d){var f=function(){function b(){this._undoUnits=[]}b.prototype.add=function(a){this._undoUnits.push(a)};b.prototype.undo=function(){for(var a=0;a<this._undoUnits.length;a++)this._undoUnits[a].undo()};b.prototype.redo=function(){for(var a=0;a<this._undoUnits.length;a++)this._undoUnits[a].redo()};Object.defineProperty(b.prototype,"isEmpty",{get:function(){if(0<this._undoUnits.length)for(var a=0;a<this._undoUnits.length;a++)if(!this._undoUnits[a].isEmpty)return!1;return!0},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"undoUnits",{get:function(){return this._undoUnits},enumerable:!0,configurable:!0});b.prototype.toString=function(){for(var a="Container:\n",c=0;c<this._undoUnits.length;c++)a+="\t"+this._undoUnits[c].toString()+"\n";return a};return b}();d.ContainerUndoUnit=f})(Textor||(Textor={}));
(function(d){var f=function(){function b(a){this._timeoutEnabled=!1;this._language=null;this._syntaxTable=[];this._textEditor=a}Object.defineProperty(b.prototype,"language",{get:function(){return this._language},set:function(a){this._language=a},enumerable:!0,configurable:!0});b.prototype.getStyles=function(a){return this._syntaxTable[a]?this._syntaxTable[a]:[]};b.prototype.invalidate=function(a,c,h){if(null!==this._language){this._timeoutEnabled&&(window.clearTimeout(this._timeout),this._timeoutEnabled=
!1);var b=null;this._column=this._line=0;if(0<this._syntaxTable.length){for(var e=a.start.line,d=0;this._syntaxTable[e]&&d<this._syntaxTable[e].length&&a.start.column>this._syntaxTable[e][d].start;)d++;for(;0<=e&&0<=d;)if(d--,0>d&&(e--,d=this._syntaxTable[e]?this._syntaxTable[e].length-1:0),this._syntaxTable[e]&&this._syntaxTable[e][d]&&null!==this._syntaxTable[e][d].state){b=this._syntaxTable[e][d].state;this._line=e;this._column=this._syntaxTable[e][d].start;break}}this.moveRange(a.end.clone(),
c.end.clone());0<h.length&&this.clearRange(c.start,c.end);for(this._index=0;this._syntaxTable[this._line]&&this._index<this._syntaxTable[this._line].length&&this._column>this._syntaxTable[this._line][this._index].start;)this._index++;this._textReader=this._textEditor.createTextReader();this._textReader.textPosition.line=this._line;this._textReader.textPosition.column=this._column;this._language.begin(this._textReader,b);this._style="text";this.window_setTimeout()}};b.prototype.window_setTimeout=function(){for(var a=
(new Date).getTime()+20,c=new d.TextPosition(this._line,this._column),h=this._textReader.textPosition.line,b=this._textReader.textPosition.column;0<this._textReader.peek().length;){var e=this._language.read(),f=this._textReader.peek();if(0===f.length||null!==e.style||null!==e.state){if(0===f.length||e.style!==this._style||e.state!==this._state||null!==e.state){if(0===f.length||h!==this._line||b!==this._column||null!==e.state)this.addRecord(this._column,h,this._style,this._state),this._column=b;this._style=
e.style;this._state=e.state}h=this._textReader.textPosition.line;b=this._textReader.textPosition.column}if((new Date).getTime()>a)break}0<this._textReader.peek().length?(this._timeout=window.setTimeout(this.window_setTimeout.bind(this),100),this._timeoutEnabled=!0):this.addRecord(this._column,this._line,this._style,null);this._textEditor.invalidateRange(new d.TextRange(c,new d.TextPosition(this._line,this._column)));this._textEditor.update()};b.prototype.moveRange=function(a,c){if(0>a.compareTo(c)){for(var h=
0;this._syntaxTable[a.line]&&h<this._syntaxTable[a.line].length&&a.column>this._syntaxTable[a.line][h].start;)h++;if(this._syntaxTable[a.line]){for(var b=this._syntaxTable[a.line].splice(h,this._syntaxTable[a.line].length-h),e=0;e<b.length;e++)b[e].start+=c.column-a.column;var d=c.line-a.line;if(0<d){for(var f=Array(d),e=0;e<d;e++)f[e]=0<h?[{style:this._syntaxTable[a.line][h-1].style,state:null,start:0}]:[];h=this._syntaxTable.splice(a.line+1,this._syntaxTable.length-a.line+1);this._syntaxTable=this._syntaxTable.concat(f,
h)}this._syntaxTable[c.line]=this._syntaxTable[c.line].concat(b)}}else if(0<a.compareTo(c)){h=0;if(a.line>=this._syntaxTable.length)a.line=this._syntaxTable.length-1,h=this._syntaxTable[a.line].length-1;else for(;this._syntaxTable[a.line]&&h<this._syntaxTable[a.line].length&&a.column>this._syntaxTable[a.line][h].start;)h++;if(this._syntaxTable[a.line]){b=this._syntaxTable[a.line].splice(h,this._syntaxTable[a.line].length-h);for(e=0;e<b.length;e++)b[e].start-=a.column-c.column;for(h=0;this._syntaxTable[c.line]&&
h<this._syntaxTable[c.line].length&&c.column>this._syntaxTable[c.line][h].start;)h++;this._syntaxTable.splice(c.line+1,a.line-c.line);this._syntaxTable[c.line].splice(h,this._syntaxTable[c.line].length-h);this._syntaxTable[c.line]=this._syntaxTable[c.line].concat(b)}}};b.prototype.clearRange=function(a,c){if(a.line===c.line){var b=this._syntaxTable[a.line];if(b)for(var d=-1,e=0;e<b.length;e++)if(-1===d&&a.column>=b[e].start&&(d=e),-1!==d&&c.column>=b[e].start){this._syntaxTable[a.line].splice(d,e-
d);break}}else{if(this._syntaxTable[a.line])for(e=this._syntaxTable[a.line].length-1;0<=e;e--)this._syntaxTable[a.line][e].start>a.column&&this._syntaxTable[a.line].splice(e,1);for(e=a.line+1;e<c.line;e++)this._syntaxTable[e]=[];if(this._syntaxTable[c.line])for(e=this._syntaxTable[c.line].length-1;0<=e;e--)this._syntaxTable[c.line][e].start<c.column&&this._syntaxTable[c.line].splice(e,1)}};b.prototype.addRecord=function(a,c,b,g){this._syntaxTable[this._line]=this._syntaxTable[this._line]||[];if(0<
this._index&&this._index-1<this._syntaxTable[this._line].length&&this._syntaxTable[this._line][this._index-1].start===this._column){var e=this._syntaxTable[this._line][this._index-1];e.style=b;null!==g&&(e.state=g)}else this._index<this._syntaxTable[this._line].length?(e=this._syntaxTable[this._line][this._index],a>=e.start?(e.start=a,e.style=b,e.state=g):this._syntaxTable[this._line].splice(this._index,0,new d.LanguageStyle(b,g,a))):this._syntaxTable[this._line].push(new d.LanguageStyle(b,g,a)),
this._index++;for(;this._line<c;)this._syntaxTable[this._line].splice(this._index,this._syntaxTable[this._line].length-this._index),this._line++,this._index=0,this.addRecord(0,this._line,b,null)};b.prototype.log=function(){for(var a=0;a<this._syntaxTable.length;a++){var c="line "+a+": ";if(this._syntaxTable[a]){for(var c=c+"[ ",b=0;b<this._syntaxTable[a].length;b++)c+=this._syntaxTable[a][b].start+this._syntaxTable[a][b].style[0]+(null!==this._syntaxTable[a][b].state?"X":"-")+" ";c+=" ]"}console.log(c)}return"-"};
return b}();d.LanguageService=f})(Textor||(Textor={}));(function(d){var f=function(){return function(b,a,c){this.style=b;this.state=a;this.start=c}}();d.LanguageStyle=f})(Textor||(Textor={}));(function(d){var f=function(){function b(a,c){this.x=a;this.y=c}b.prototype.equals=function(a){return this.x===a.x&&this.y===a.y};return b}();d.Point=f})(Textor||(Textor={}));
(function(d){var f=function(){function b(a,c,b,d){this.x=a;this.y=c;this.width=b;this.height=d}b.prototype.union=function(a){var c=this.x<a.x?this.x:a.x,h=this.y<a.y?this.y:a.y;return new b(c,h,(this.x+this.width<a.x+a.width?a.x+a.width:this.x+this.width)-c,(this.y+this.height<a.y+a.height?a.y+a.height:this.y+this.height)-h)};b.prototype.toString=function(){return"("+this.x+","+this.y+")-("+this.width+","+this.height+")"};return b}();d.Rectangle=f})(Textor||(Textor={}));
(function(d){var f=function(){return function(b,a){this.oldRange=b;this.newRange=a}}();d.SelectionChangeEvent=f})(Textor||(Textor={}));
(function(d){var f=function(){function b(a,c){this._textModel=a;this._redoTextRange=c;this._undoTextRange=this._textModel.getTextRange()}b.prototype.undo=function(){this._textModel.selectRange(this._undoTextRange)};b.prototype.redo=function(){this._textModel.selectRange(this._redoTextRange)};Object.defineProperty(b.prototype,"isEmpty",{get:function(){return!1},enumerable:!0,configurable:!0});b.prototype.merge=function(a){return a instanceof b?(this._redoTextRange=a.redoTextRange,!0):!1};b.prototype.toString=
function(){return"Selection: "+this._redoTextRange.toString()+" => "+this._undoTextRange.toString()};Object.defineProperty(b.prototype,"redoTextRange",{get:function(){return this._redoTextRange},enumerable:!0,configurable:!0});return b}();d.SelectionUndoUnit=f})(Textor||(Textor={}));(function(d){var f=function(){return function(b,a){this.width=b;this.height=a}}();d.Size=f})(Textor||(Textor={}));
(function(d){var f=function(){function b(){this._lines=[""];this._textChangingHandlers=[];this._textChangedHandlers=[]}b.prototype.addEventListener=function(a,c){switch(a){case "textchanging":this._textChangingHandlers.push(c);break;case "textchanged":this._textChangedHandlers.push(c)}};b.prototype.removeEventListener=function(a,c){switch(a){case "textchanging":this._textChangingHandlers.remove(c);break;case "textchanged":this._textChangedHandlers.remove(c)}};b.prototype.setText=function(a,c){var b=
c.split("\n"),g=b.length-1,e=new d.TextRange(a.start.clone(),new d.TextPosition(a.start.line+g,(1===b.length?a.start.column:0)+b[g].length));b[0]=this._lines[a.start.line].substring(0,a.start.column)+b[0];b[g]+=this._lines[a.end.line].substring(a.end.column);this.onTextChanging(new d.TextChangeEvent(a,e,c));this._lines=this._lines.slice(0,a.start.line).concat(b,this._lines.slice(a.end.line+1));this.onTextChanged(new d.TextChangeEvent(a,e,c));return e};b.prototype.getText=function(a){if(a.start.line!==
a.end.line){var c=[];c.push(this._lines[a.start.line].substring(a.start.column));c=c.concat(this._lines.slice(a.start.line+1,a.end.line));c.push(this._lines[a.end.line].substring(0,a.end.column));return c.join("\n")}return this._lines[a.start.line].substring(a.start.column,a.end.column)};b.prototype.getTextRange=function(){return new d.TextRange(new d.TextPosition(0,0),new d.TextPosition(this._lines.length-1,this._lines[this._lines.length-1].length))};b.prototype.getLines=function(){return this._lines.length};
b.prototype.getColumns=function(a){return this._lines[a].length};b.prototype.getLine=function(a){return this._lines[a]};b.prototype.onTextChanged=function(a){for(var c=0;c<this._textChangedHandlers.length;c++)this._textChangedHandlers[c](a)};b.prototype.onTextChanging=function(a){for(var c=0;c<this._textChangingHandlers.length;c++)this._textChangingHandlers[c](a)};return b}();d.TextBuffer=f})(Textor||(Textor={}));
(function(d){var f=function(){return function(b,a,c){this.oldRange=b;this.newRange=a;this.text=c}}();d.TextChangeEvent=f})(Textor||(Textor={}));
(function(d){var f=function(){function b(a,c){var b=this;this._textEditor=a;this._canvas=c;this._isWebKit="undefined"!==typeof navigator.userAgent.split("WebKit/")[1];this._isChrome=-1<navigator.userAgent.toLowerCase().indexOf("chrome");this._isMozilla=0<=navigator.appVersion.indexOf("Gecko/")||0<=navigator.userAgent.indexOf("Gecko")&&!this._isWebKit&&"undefined"!==typeof navigator.appVersion;this._isMac=/Mac/.test(navigator.userAgent);this._textArea=document.createElement("textarea");this._textArea.style.position=
"absolute";this._textArea.style.top="0";this._textArea.style.left="0";this._textArea.style.width="0";this._textArea.style.height="0";this._textArea.style.zIndex="-99999";this._textArea.style.margin="0";this._textArea.style.border="0";this._textArea.style.padding="1px";this._textArea.style.resize="none";this._textArea.style.outline="none";this._textArea.style.overflow="hidden";this._textArea.style.background="none";this._textArea.value=".";document.body.appendChild(this._textArea);this.updateTextAreaPosition();
this._canvas_mouseDownHandler=function(a){b.canvas_mouseDown(a)};this._canvas_mouseWheelHandler=function(a){b.canvas_mouseWheel(a)};this._canvas_touchStartHandler=function(a){b.canvas_touchStart(a)};this._canvas_focusHandler=function(a){b.canvas_focus(a)};this._window_mouseUpHandler=function(a){b.window_mouseUp(a)};this._window_mouseMoveHandler=function(a){b.window_mouseMove(a)};this._canvas_touchEndHandler=function(a){b.canvas_touchEnd(a)};this._canvas_touchMoveHandler=function(a){b.canvas_touchMove(a)};
this._textArea_keyUpHandler=function(a){b.textArea_keyUp(a)};this._textArea_keyDownHandler=function(a){b.textArea_keyDown(a)};this._textArea_keyPressHandler=function(a){b.textArea_keyPress(a)};this._textArea_focusHandler=function(a){b.textArea_focus(a)};this._textArea_blurHandler=function(a){b.textArea_blur(a)};this._textArea_cutHandler=function(a){b.textArea_cut(a)};this._textArea_copyHandler=function(a){b.textArea_copy(a)};this._textArea_pasteHandler=function(a){b.textArea_paste(a)};this._textArea_beforeCutHandler=
function(a){b.textArea_beforeCut(a)};this._textArea_beforeCopyHandler=function(a){b.textArea_beforeCopy(a)};this._canvas.addEventListener("focus",this._canvas_focusHandler,!1);this._canvas.addEventListener("onmousewheel"in this._canvas?"mousewheel":"DOMMouseScroll",this._canvas_mouseWheelHandler,!1);this._canvas.addEventListener("touchstart",this._canvas_touchStartHandler,!1);this._canvas.addEventListener("touchmove",this._canvas_touchMoveHandler,!1);this._canvas.addEventListener("touchend",this._canvas_touchEndHandler,
!1);this._canvas.addEventListener("mousedown",this._canvas_mouseDownHandler,!1);window.addEventListener("mousemove",this._window_mouseMoveHandler,!1);window.addEventListener("mouseup",this._window_mouseUpHandler,!1);this._textArea.addEventListener("focus",this._textArea_focusHandler,!1);this._textArea.addEventListener("blur",this._textArea_blurHandler,!1);this._textArea.addEventListener("cut",this._textArea_cutHandler,!1);this._textArea.addEventListener("copy",this._textArea_copyHandler,!1);this._textArea.addEventListener("paste",
this._textArea_pasteHandler,!1);this._textArea.addEventListener("beforecut",this._textArea_beforeCutHandler,!1);this._textArea.addEventListener("beforecopy",this._textArea_beforeCopyHandler,!1);this._textArea.addEventListener("keydown",this._textArea_keyDownHandler,!1);this._textArea.addEventListener("keypress",this._textArea_keyPressHandler,!1);this._textArea.addEventListener("keyup",this._textArea_keyUpHandler,!1)}b.prototype.dispose=function(){window.removeEventListener("mousemove",this._window_mouseMoveHandler);
window.removeEventListener("mouseup",this._window_mouseUpHandler);this._canvas.removeEventListener("mousedown",this._canvas_mouseDownHandler);this._canvas.removeEventListener("touchend",this._canvas_touchEndHandler);this._canvas.removeEventListener("touchmove",this._canvas_touchMoveHandler);this._canvas.removeEventListener("touchstart",this._canvas_touchStartHandler);this._canvas.removeEventListener("focus",this._canvas_focusHandler);this._canvas.removeEventListener("onmousewheel"in this._canvas?
"mousewheel":"DOMMouseScroll",this._canvas_mouseWheelHandler,!1);this._textArea.removeEventListener("focus",this._textArea_focusHandler);this._textArea.removeEventListener("blur",this._textArea_blurHandler);this._textArea.removeEventListener("cut",this._textArea_cutHandler);this._textArea.removeEventListener("copy",this._textArea_copyHandler);this._textArea.removeEventListener("paste",this._textArea_pasteHandler);this._textArea.removeEventListener("beforecut",this._textArea_beforeCutHandler);this._textArea.removeEventListener("beforecopy",
this._textArea_beforeCopyHandler);this._textArea.removeEventListener("keypress",this._textArea_keyPressHandler);this._textArea.removeEventListener("keyup",this._textArea_keyUpHandler);this._textArea.removeEventListener("keydown",this._textArea_keyDownHandler)};b.prototype.isFocused=function(){return/(^|\s+)focus(\s+|$)/.test(this._canvas.className)};b.prototype.focus=function(){this._textArea.focus()};b.prototype.copy=function(a){if(this._isMozilla||this._isWebKit)this._textArea.value=a,this._textArea.select()};
Object.defineProperty(b.prototype,"isMozilla",{get:function(){return this._isMozilla},enumerable:!0,configurable:!0});b.prototype.textArea_cut=function(a){this._textEditor.cut()};b.prototype.textArea_copy=function(a){this._textEditor.copy()};b.prototype.textArea_paste=function(a){if(this._isMozilla)this._textArea.value="",window.setTimeout(function(){var a=this._textArea.value;0<a.length&&this._textEditor.paste(a)}.bind(this),1);else if(this._isWebKit){var c=a.clipboardData.getData("text/plain");
this._textEditor.paste(c);this.stopEvent(a)}};b.prototype.textArea_beforeCut=function(a){this._textEditor.copy()};b.prototype.textArea_beforeCopy=function(a){this._textEditor.copy()};b.prototype.textArea_focus=function(a){this.isFocused()||(this._canvas.className+=" focus");this._textArea.select();this._textEditor.invalidate();this._textEditor.update()};b.prototype.textArea_blur=function(a){this.isFocused()&&(this._canvas.className=this._canvas.className.replace(/ focus\b/,""));this._textEditor.invalidate()};
b.prototype.canvas_focus=function(a){this._textEditor.focus()};b.prototype.canvas_mouseDown=function(a){this._textEditor.focus();this.stopEvent(a);this.updatePointerPosition(a.pageX,a.pageY);var c=this.getTextPosition(),b=(a.detail-1)%3+1;1===b?(a.shiftKey?this._textEditor.selectTo(c.line,c.column):this.pointerDown(),this._mouseCapture=!0,this.startScrollTimer()):2===b?(this._textEditor.selectWord(c.line,c.column),this._mouseCapture=!0,this.startScrollTimer()):3===b&&this._textEditor.selectRange(c.line,
0,c.line+1,0);this.updateMouseCursor()};b.prototype.window_mouseUp=function(a){a.preventDefault();this.updatePointerPosition(a.pageX,a.pageY);this.pointerUp()};b.prototype.window_mouseMove=function(a){a.preventDefault();this.updatePointerPosition(a.pageX,a.pageY);this.pointerMove()};b.prototype.canvas_mouseWheel=function(a){a.preventDefault();var c=0;a||(c=window.event.wheelDelta/120);a.wheelDelta?c=a.wheelDelta/120:a.detail&&(c=-a.detail/3);0!==c&&(this._textEditor.scroll(Math.floor(-c),0),this._textEditor.update())};
b.prototype.canvas_touchStart=function(a){this._textEditor.focus();1===a.touches.length&&(a.preventDefault(),this.updatePointerPosition(a.touches[0].pageX,a.touches[0].pageY),this.pointerDown())};b.prototype.canvas_touchMove=function(a){1===a.touches.length&&(a.preventDefault(),this.updatePointerPosition(a.touches[0].pageX,a.touches[0].pageY),this.pointerMove())};b.prototype.canvas_touchEnd=function(a){a.preventDefault();this.pointerUp()};b.prototype.textArea_keyUp=function(a){a.preventDefault()};
b.prototype.textArea_keyDown=function(a){!this._isMozilla&&this.processKey(a.keyCode,a.shiftKey,a.ctrlKey,a.altKey,a.metaKey)&&(this._textEditor.update(),this.stopEvent(a))};b.prototype.textArea_keyPress=function(a){var c;if(this._isMozilla){if(!this._keyCodeTable){this._keyCodeTable=[];var b={32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",
82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",188:",",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:'"'};for(c in b){var d=b[c];this._keyCodeTable[d.charCodeAt(0)]=parseInt(c);d.toUpperCase()!=d&&(this._keyCodeTable[d.toUpperCase().charCodeAt(0)]=parseInt(c))}}c=0!==a.charCode&&this._keyCodeTable[a.charCode]?this._keyCodeTable[a.charCode]:a.keyCode;if(this.processKey(c,a.shiftKey,a.ctrlKey,a.altKey,a.metaKey)){this._textEditor.update();this.stopEvent(a);
return}}a.ctrlKey!=a.altKey||a.metaKey||0===a.charCode||(this.stopEvent(a),a=String.fromCharCode(a.charCode),this._textEditor.insertText(a),this._textEditor.updateScrollPosition(),this._textEditor.update())};b.prototype.mouseScroll=function(){var a=this.getTextPosition();this._textEditor.selectTo(a.line,a.column);this._textEditor.updateScrollPosition();this._textEditor.update()};b.prototype.mouseScroll_interval=function(){var a=this.getTextCoordinate(),c=this._textEditor.size;(0>a.line||a.line>=c.line||
0>a.column||a.column>=c.column)&&this.mouseScroll()};b.prototype.pointerDown=function(){var a=this.getTextPosition();this._textEditor.select(a.line,a.column)};b.prototype.pointerMove=function(){this._mouseCapture&&this.mouseScroll();this.updateMouseCursor()};b.prototype.pointerUp=function(){this._mouseCapture=!1;this.stopScrollTimer();this.updateMouseCursor()};b.prototype.startScrollTimer=function(){this.stopScrollTimer();this._scrollTimer=window.setInterval(this.mouseScroll_interval.bind(this),75)};
b.prototype.stopScrollTimer=function(){null!==this._scrollTimer&&(window.clearInterval(this._scrollTimer),this._scrollTimer=null)};b.prototype.stopEvent=function(a){a.preventDefault();a.stopPropagation()};b.prototype.updateMouseCursor=function(){this._canvas.style.cursor="text"};b.prototype.updateTextAreaPosition=function(){for(var a=new d.Point(0,0),c=this._canvas;null!==c;)a.x+=c.offsetLeft,a.y+=c.offsetTop,c=c.offsetParent;this._textArea.style.top=a.y+"px";this._textArea.style.left=a.x+"px"};b.prototype.updatePointerPosition=
function(a,c){this._pointerPosition=new d.Point(a*window.devicePixelRatio,c*window.devicePixelRatio);for(var b=this._canvas;null!==b;)this._pointerPosition.x-=b.offsetLeft*window.devicePixelRatio,this._pointerPosition.y-=b.offsetTop*window.devicePixelRatio,b=b.offsetParent};b.prototype.getTextCoordinate=function(){return this._textEditor.getTextPosition(new d.Point(this._pointerPosition.x+this._textEditor.fontSize.width/2,this._pointerPosition.y))};b.prototype.getTextPosition=function(){var a=this.getTextCoordinate();
a.line+=this._textEditor.scrollPosition.line;a.column+=this._textEditor.scrollPosition.column;return a};b.prototype.processKey=function(a,c,b,d,e){this._isMac&&(!b||c||d||e?e&&37===a?(e=!1,a=36):e&&39===a&&(e=!1,a=35):65===a?(b=!1,a=36):69===a&&(b=!1,a=35));return this._textEditor.processKey(a,c,b,d,e)};return b}();d.TextController=f})(Textor||(Textor={}));
(function(d){var f=function(){function b(a){var c=this;this._undoService=new d.UndoService;this._textChangingHandlers=[];this._textChangedHandlers=[];this._selectionChangedHandlers=[];this._scrollPosition=new d.TextPosition(0,0);this._invalidRectangles=[];this._maxColumns=-1;this._blinkTimerEnabled=!1;this._blinkState=!0;this._canvas=a;this._context=a.getContext("2d");this._textBuffer_textChanging=function(a){c.textBuffer_textChanging(a)};this._textBuffer_textChanged=function(a){c.textBuffer_textChanged(a)};
this._textModel_selectionChanged=function(a){c.textModel_selectionChanged(a)};this._textBuffer=new d.TextBuffer;this._textBuffer.addEventListener("textchanging",this._textBuffer_textChanging);this._textBuffer.addEventListener("textchanged",this._textBuffer_textChanged);this._textModel=new d.TextModel(this._undoService,this._textBuffer);this._textModel.addEventListener("selectionchanged",this._textModel_selectionChanged);this._textModel.tabSize=4;this._textController=new d.TextController(this,this._canvas);
this._languageService=new d.LanguageService(this);this._theme={fontFamily:"Monaco,Lucida Console,Courier New",fontSize:"12",paddingLeft:"4",paddingTop:"4",backgroundColor:"#ffffff",backgroundBlurColor:"#ffffff",selectionColor:"#c0ddf6",selectionBlurColor:"#e3f1fe",cursorColor:"#000000",cursorBackgroundColor:"#ededed",textStyle:"#000000",punctuationStyle:"#666666",commentStyle:"#0068c5 italic",keywordStyle:"#662266 bold",literalStyle:"#005a15",elementStyle:"#0000AA bold",attributeStyle:"#0000AA italic",
errorStyle:"#FF0000 bold",declarationStyle:"#000000 bold"};this.updateFont();this.invalidate();this.update();this.focus()}b.prototype.dispose=function(){this._textController.dispose();this._textController=null;this._textModel.removeEventListener("selectionchanged",this._textModel_selectionChanged);this._textBuffer.removeEventListener("textchanging",this._textBuffer_textChanging);this._textBuffer.removeEventListener("textchanged",this._textBuffer_textChanged);this._textChangedHandlers=[];this._selectionChangedHandlers=
[]};b.prototype.addEventListener=function(a,c){switch(a){case "textchanging":this._textChangingHandlers.push(c);break;case "textchanged":this._textChangedHandlers.push(c);break;case "selectionchanged":this._selectionChangedHandlers.push(c)}};b.prototype.removeEventListener=function(a,c){switch(a){case "textchanging":this._textChangingHandlers.remove(c);break;case "textchanged":this._textChangedHandlers.remove(c);break;case "selectionchanged":this._selectionChangedHandlers.remove(c)}};Object.defineProperty(b.prototype,
"theme",{get:function(){return this._theme},set:function(a){for(var c in a)this._theme[c]=a[c],"fontFamily"!==c&&"fontSize"!==c||this.updateFont();this.invalidate();this.update()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"language",{get:function(){return this._languageService.language},set:function(a){this._languageService.language=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"tabSize",{get:function(){return this._textModel.tabSize},set:function(a){this._textModel.tabSize=
a;this.invalidate();this.update()},enumerable:!0,configurable:!0});b.prototype.focus=function(){this._textController.focus()};Object.defineProperty(b.prototype,"text",{get:function(){return this._textBuffer.getText(this._textBuffer.getTextRange())},set:function(a){this._undoService.begin();this._undoService.add(new d.TextUndoUnit(this._textModel,this._textBuffer,this._textBuffer.getTextRange(),a));this._undoService.add(new d.SelectionUndoUnit(this._textModel,new d.TextRange(new d.TextPosition(0,0),
new d.TextPosition(0,0))));this._undoService.commit();this._undoService.clear();this.update()},enumerable:!0,configurable:!0});b.prototype.insertText=function(a){this._textModel.insertText(a)};b.prototype.deleteSelection=function(){this._textModel.deleteSelection(null)};b.prototype.select=function(a,c){a>this._textBuffer.getLines()-1&&(a=this._textBuffer.getLines()-1,c>this._textBuffer.getColumns(a)-1&&(c=this._textBuffer.getColumns(a)-1));var b=new d.TextPosition(a,c),g=this._textModel.toScreenPosition(this._textModel.toBufferPosition(b)),
b=this._textModel.toScreenPosition(this._textModel.toBufferPosition(b));this._undoService.begin();this._undoService.add(new d.SelectionUndoUnit(this._textModel,new d.TextRange(g,b)));this._undoService.commit();this.updateScrollPosition();this.update()};b.prototype.selectRange=function(a,c,b,g){this._undoService.begin();this._undoService.add(new d.SelectionUndoUnit(this._textModel,new d.TextRange(new d.TextPosition(a,c),new d.TextPosition(b,g))));this._undoService.commit();this.updateScrollPosition();
this.update()};b.prototype.selectAll=function(){this._undoService.begin();this._undoService.add(new d.SelectionUndoUnit(this._textModel,this._textModel.toScreenRange(this._textBuffer.getTextRange())));this._undoService.commit();this.update()};b.prototype.selectTo=function(a,c){var b=new d.TextPosition(a,c);0>b.line&&(b.line=0);b.line>=this._textBuffer.getLines()&&(b.line=this._textBuffer.getLines()-1);0>b.column&&(b.column=0);b=this._textModel.toScreenPosition(this._textModel.toBufferPosition(b));
this._textModel.textRange.end.equals(b)||(this._undoService.begin(),this._undoService.add(new d.SelectionUndoUnit(this._textModel,new d.TextRange(this._textModel.textRange.start.clone(),b))),this._undoService.commit(),this.updateScrollPosition(),this.update())};b.prototype.selectWord=function(a,c){var b=this._textModel.toBufferPosition(new d.TextPosition(a,c)),g=this._textBuffer.getLine(b.line),e=this._textModel.findWordBreak(g,b.column+1,-1),g=this._textModel.findWordBreak(g,b.column,1),b=new d.TextRange(new d.TextPosition(b.line,
e),new d.TextPosition(b.line,g));this._undoService.begin();this._undoService.add(new d.SelectionUndoUnit(this._textModel,this._textModel.toScreenRange(b)));this._undoService.commit();this.update()};b.prototype.scroll=function(a,c){this._scrollPosition.line+=a;this._scrollPosition.column+=c;var b=this.size,d=0>this._textBuffer.getLines()-b.line?0:this._textBuffer.getLines()-b.line,b=0>this.getMaxColumns()-b.column+1?0:this.getMaxColumns()-b.column+1;0>this._scrollPosition.line&&(this._scrollPosition.line=
0);this._scrollPosition.line>d&&(this._scrollPosition.line=d);0>this._scrollPosition.column&&(this._scrollPosition.column=0);this._scrollPosition.column>b&&(this._scrollPosition.column=b);this.invalidate()};Object.defineProperty(b.prototype,"scrollPosition",{get:function(){return this._scrollPosition},enumerable:!0,configurable:!0});b.prototype.undo=function(){this._undoService.undo();this.updateScrollPosition();this.update()};b.prototype.redo=function(){this._undoService.redo();this.updateScrollPosition();
this.update()};b.prototype.cut=function(){this.copy();this.deleteSelection();this.updateScrollPosition();this.update()};b.prototype.copy=function(){var a=this._textModel.toBufferRange(this._textModel.getTextRange());a.isEmpty||(a=this._textBuffer.getText(a),window.clipboardData&&window.clipboardData.getData?window.clipboardData.setData("Text",a):this._textController.copy(a))};b.prototype.paste=function(a){a&&(this.insertText(a),this.updateScrollPosition(),this.update())};b.prototype.createTextReader=
function(){return new d.TextReader(this._textBuffer)};b.prototype.processKey=function(a,c,b,d,e){if((b||e)&&!d){if(65===a)return this.selectAll(),!0;if(88===a){if(window.clipboardData&&window.clipboardData.setData)return this.cut(),!0}else if(67===a){if(window.clipboardData&&window.clipboardData.setData)return this.copy(),!0}else if(86===a){if(window.clipboardData&&window.clipboardData.getData){var f=window.clipboardData.getData("Text");if(f)return this.paste(f),!0}}else{if(90===a&&!c)return this.undo(),
!0;if(90===a&&c||89===a)return this.redo(),!0}}if(!e&&!d){if(37===a)return this._textModel.moveCursor("column",b?"word":"1","previous",c),this.updateScrollPosition(),!0;if(39===a)return this._textModel.moveCursor("column",b?"word":"1","next",c),this.updateScrollPosition(),!0;if(38===a)return b?this.scroll(-1,0):(this._textModel.moveCursor("line","1","previous",c),this.updateScrollPosition()),!0;if(40===a)return b?this.scroll(1,0):(this._textModel.moveCursor("line","1","next",c),this.updateScrollPosition()),
!0;if(!b){if(8===a)return this._textModel.deleteSelection("previous"),this.updateScrollPosition(),!0;if(9===a)return this.insertText("\t"),this.updateScrollPosition(),!0;if(13===a)return this.insertText("\n"+this._textModel.getIndent()),this.updateScrollPosition(),!0;if(45===a)return this._textModel.insertText(" "),this.updateScrollPosition(),!0;if(46===a)return this._textModel.deleteSelection("next"),this.updateScrollPosition(),!0;if(32===a)return this.insertText(" "),this.updateScrollPosition(),
!0;if(33===a)return c?(this._textModel.moveCursor("line",this.size.line.toString(),"previous",c),this.updateScrollPosition()):this.scroll(-this.size.line,0),!0;if(34===a)return c?(this._textModel.moveCursor("line",this.size.line.toString(),"next",c),this.updateScrollPosition()):this.scroll(+this.size.line,0),!0;if(35===a)return this._textModel.moveCursor("column","boundary","next",c),this.updateScrollPosition(),!0;if(36===a)return this._textModel.moveCursor("column","boundary","previous",c),this.updateScrollPosition(),
!0}}};b.prototype.updateScrollPosition=function(){var a=this.size;a.line--;a.column--;var c=this._textModel.textRange.end.clone();c.line>this._textBuffer.getLines()-1&&(c.line=this._textBuffer.getLines()-1);var b=this._textModel.toScreenPosition(new d.TextPosition(c.line,this._textBuffer.getColumns(c.line)));c.column>b.column-1&&(c.column=b.column-1);c.line-=this._scrollPosition.line;c.column-=this._scrollPosition.column;var g=b=0;0>c.line?b=c.line:c.line>a.line&&(b=c.line-a.line);5>c.column?(g=c.column-
5,0>this._scrollPosition.column+g&&(g=-this._scrollPosition.column)):c.column>a.column-5&&(g=c.column-a.column+5,c=this.getMaxColumns(),this._scrollPosition.column+g+a.column>c+1&&(g=c-a.column-this._scrollPosition.column+1));0===g&&0===b||this.scroll(b,g)};b.prototype.updateFont=function(){this._context.font=this._theme.fontSize+"px "+this._theme.fontFamily;var a=this._context.measureText("XXXXXXXXXXXXXXXXXXXX").width/20,c=Math.floor(1.5*parseFloat(this._theme.fontSize));this._fontSize=new d.Size(a,
c)};Object.defineProperty(b.prototype,"fontSize",{get:function(){return this._fontSize},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"size",{get:function(){return this.getTextPosition(new d.Point(this._canvas.width,this._canvas.height))},enumerable:!0,configurable:!0});b.prototype.getTextPosition=function(a){var c=parseFloat(this._theme.paddingLeft),b=parseFloat(this._theme.paddingTop);return new d.TextPosition(Math.floor((a.y-b)/this.fontSize.height),Math.floor((a.x-c)/this.fontSize.width))};
b.prototype.getMaxColumns=function(){if(-1===this._maxColumns)for(var a=0;a<this._textBuffer.getLines();a++){var c=this._textModel.getColumns(a);this._maxColumns<c&&(this._maxColumns=c)}return this._maxColumns};b.prototype.invalidate=function(){this.invalidateRectangle(new d.Rectangle(0,0,this._canvas.width,this._canvas.height))};b.prototype.invalidateSelection=function(a){this.invalidateRange(a);parseFloat(this._theme.paddingLeft);var c=parseFloat(this._theme.paddingTop),b=this.fontSize;a=new d.Rectangle(0,
(a.end.line-this._scrollPosition.line)*b.height+c,this._canvas.width,b.height);this.invalidateRectangle(a)};b.prototype.invalidateRange=function(a){var c=this.fontSize,b=parseFloat(this._theme.paddingLeft),g=parseFloat(this._theme.paddingTop),e=a.normalize();e.start.line-=this._scrollPosition.line;e.end.line-=this._scrollPosition.line;e.start.column-=this._scrollPosition.column;e.end.column-=this._scrollPosition.column;g+=e.start.line*c.height;a.start.line===a.end.line?(b+=e.start.column*c.width,
this.invalidateRectangle(new d.Rectangle(b,g,(e.end.column-e.start.column)*c.width,c.height))):this.invalidateRectangle(new d.Rectangle(b,g,this._canvas.width,(e.end.line-e.start.line+1)*c.height))};b.prototype.invalidateRectangle=function(a){0>a.x&&(a.x=0);0>a.y&&(a.y=0);a.x+a.width>this._canvas.width&&(a.width=this._canvas.width-a.x);a.y+a.height>this._canvas.height&&(a.height=this._canvas.height-a.y);this._invalidRectangles.push(a)};b.prototype.update=function(){if(0!==this._invalidRectangles.length){for(var a=
this._invalidRectangles[0],c=1;c<this._invalidRectangles.length;c++)a=a.union(this._invalidRectangles[c]);if(0!==a.width&&0!==a.height){this._context.save();this._context.beginPath();this._context.rect(a.x,a.y,a.width,a.height);this._context.clip();var b=this._textController.isFocused();this._context.fillStyle=b?this._theme.backgroundColor:this._theme.backgroundBlurColor;this._context.fillRect(0,0,this._canvas.width,this._canvas.height);var a=this.size,d=this.fontSize,e=parseFloat(this._theme.paddingLeft),
f=parseFloat(this._theme.paddingTop),c=this._textModel.getTextRange();c.start.line-=this._scrollPosition.line;c.end.line-=this._scrollPosition.line;c.start.column-=this._scrollPosition.column;c.end.column-=this._scrollPosition.column;if(this._textModel.isCursor())this._context.fillStyle=this._theme.cursorBackgroundColor,b=c.start.line*d.height+f,this._context.fillRect(0,b,this._canvas.width,d.height),this._blinkState&&this._textController.isFocused()&&(this._context.fillStyle=this._theme.cursorColor,
this._context.fillRect(e+c.start.column*d.width,b,1,d.height));else{this._context.fillStyle=b?this._theme.selectionColor:this._theme.selectionBlurColor;for(var k=b=0;k<a.line;k++){var n=0,l=this._canvas.width;k===c.start.line&&(n=0>c.start.column?0:c.start.column*d.width);k===c.end.line&&(l=c.end.column*d.width-n);k>=c.start.line&&k<=c.end.line&&0<l&&this._context.fillRect(n+e,b+f,l,d.height);b+=d.height}}var n={text:!0},l=["text"],x=this._context.font;this._context.shadowOffsetX=0;for(c=this._context.shadowOffsetY=
0;c<l.length;c++){var y=l[c],b=this._theme[y+"Style"].split(" ");this._context.fillStyle=b[0];this._context.font=2===b.length&&"italic"===b[1]?"italic "+x:x;2===b.length&&"bold"===b[1]?(this._context.shadowBlur=this._textController.isMozilla?.5:1,this._context.shadowColor=b[0]):(this._context.shadowBlur=0,this._context.shadowColor="rgba(0,0,0,0)");b=Math.floor(.8*d.height)+f;for(k=this._scrollPosition.line;k<this._scrollPosition.line+a.line;k++){if(k<this._textBuffer.getLines())for(var u=this._textBuffer.getLine(k),
v=this._languageService.getStyles(k),p=0,q="text",r=0,m=0;m<u.length;){p<v.length&&(q=v[p].style,0!==c||n.hasOwnProperty(q)||(n[q]=!0,l.push(q)),p++);for(var z=p<v.length?v[p].start-m:u.length-m,t="",w=m;w<m+z;w++)t+="\t"!==u[w]?u[w]:this._textModel.tabText;y===q&&0<r-this._scrollPosition.column+t.length&&r-this._scrollPosition.column<a.column&&this._context.fillText(t,(r-this._scrollPosition.column)*d.width+e,b);m+=z;r+=t.length}b+=d.height}}this._context.restore()}this._invalidRectangles=[];this._textController.updateTextAreaPosition()}};
b.prototype.textBuffer_textChanging=function(a){var c=this._textModel.toScreenRange(a.oldRange.normalize());c.end.column=this.size.column+this._scrollPosition.column;c.start.line!=c.end.line&&(c.end.line=this.size.line+this._scrollPosition.line);this.invalidateRange(c);this.onTextChanging(a)};b.prototype.textBuffer_textChanged=function(a){this._maxColumns=-1;var c=this._textModel.toScreenRange(a.newRange.normalize());c.end.column=this.size.column+this._scrollPosition.column;c.start.line!=c.end.line&&
(c.end.line=this.size.line+this._scrollPosition.line);this.invalidateRange(c);this._languageService.invalidate(a.oldRange,a.newRange,a.text);this.onTextChanged(a)};b.prototype.textModel_selectionChanged=function(a){this.invalidateSelection(a.oldRange);this.invalidateSelection(a.newRange);this._blinkTimerEnabled&&(window.clearInterval(this._blinkTimer),this._blinkTimerEnabled=!1,this._blinkState=!0);var c=a.newRange.clone();c.isEmpty&&(this._blinkTimerEnabled=!0,this._blinkTimer=window.setInterval(function(){this.invalidateSelection(c);
this.update();this._blinkState=!this._blinkState}.bind(this),600));this.onSelectionChanged(a)};b.prototype.onTextChanged=function(a){for(var c=0;c<this._textChangedHandlers.length;c++)this._textChangedHandlers[c](a)};b.prototype.onTextChanging=function(a){for(var c=0;c<this._textChangingHandlers.length;c++)this._textChangingHandlers[c](a)};b.prototype.onSelectionChanged=function(a){for(var c=0;c<this._selectionChangedHandlers.length;c++)this._selectionChangedHandlers[c](a)};return b}();d.TextEditor=
f})(Textor||(Textor={}));
(function(d){var f=function(){function b(a,c){this._textRange=new d.TextRange(new d.TextPosition(0,0),new d.TextPosition(0,0));this._selectionChangedHandlers=[];this._textBuffer=c;this._undoService=a}b.prototype.addEventListener=function(a,c){switch(a){case "selectionchanged":this._selectionChangedHandlers.push(c)}};b.prototype.removeEventListener=function(a,c){switch(a){case "selectionchanged":this._selectionChangedHandlers.remove(c)}};Object.defineProperty(b.prototype,"textRange",{get:function(){return this._textRange},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"tabText",{get:function(){return this._tabText},enumerable:!0,configurable:!0});b.prototype.select=function(a){if(!a.equals(this._textRange.start)||!a.equals(this._textRange.end)){var c=this._textRange;this._textRange=new d.TextRange(new d.TextPosition(a.line,a.column),new d.TextPosition(a.line,a.column));this.onSelectionChanged(new d.SelectionChangeEvent(c,this._textRange))}};b.prototype.selectRange=function(a){if(!a.start.equals(this._textRange.start)||
!a.end.equals(this._textRange.end)){var c=this._textRange;this._textRange=a;this.onSelectionChanged(new d.SelectionChangeEvent(c,this._textRange))}};b.prototype.moveCursor=function(a,c,b,g){var e=this._textRange.end;g||(e="previous"===b?this.getTextRange().start:this.getTextRange().end,"line"===a&&(e.column="previous"===b?this._textRange.start.column:this._textRange.end.column));e=this.toBufferPosition(e);if("column"===a&&(g||this.isCursor())){if("boundary"===c)if("previous"!==b)e.column=this._textBuffer.getColumns(e.line);
else for(var f=this._textBuffer.getLine(e.line),k=0;k<f.length;k++){if(" "!==f[k]&&"\t"!==f[k]){e.column=k===e.column?0:k;break}}else"word"===c?(f=this._textBuffer.getLine(e.line),"previous"!==b&&e.column>=f.length?e.column++:"previous"===b&&0===e.column?e.column--:e.column=this.findWordBreak(f,e.column,"previous"==b?-1:1)):e.column+="previous"===b?-Number(c):+Number(c);0>e.column&&(e.line--,0>e.line?(e.line=0,e.column=0):e.column=this._textBuffer.getColumns(e.line));e.column>this._textBuffer.getColumns(e.line)&&
(e.line++,e.column=0,e.line>=this._textBuffer.getLines()&&(e.line=this._textBuffer.getLines()-1,e.column=this._textBuffer.getColumns(e.line)))}"line"===a&&("boundrary"!==c&&(e.line+="previous"===b?-Number(c):+Number(c)),0>e.line?(e.line=0,e.column=0):e.line>this._textBuffer.getLines()-1&&(e.line=this._textBuffer.getLines()-1,e.column=this._textBuffer.getColumns(e.line)));e=this.toScreenPosition(e);a=g?new d.TextRange(new d.TextPosition(this._textRange.start.line,this._textRange.start.column),e):new d.TextRange(e,
e);this._undoService.begin();this._undoService.add(new d.SelectionUndoUnit(this,a));this._undoService.commit()};b.prototype.insertText=function(a){this._undoService.begin();this._undoService.add(new d.TextUndoUnit(this,this._textBuffer,this.toBufferRange(this.getTextRange()),a));this._undoService.commit()};b.prototype.deleteSelection=function(a){if(this.isCursor()&&null!==a){var b=this.toBufferRange(this.getTextRange());"previous"===a?(b.start.column--,0>b.start.column&&(b.start.line--,0>b.start.line?
(b.start.line=0,b.start.column=0):b.start.column=this._textBuffer.getColumns(b.start.line))):"next"===a&&(b.end.column++,b.end.column>this._textBuffer.getColumns(b.end.line)&&(b.end.line++,b.end.line>this._textBuffer.getLines()-1?(b.end.line=this._textBuffer.getLines()-1,b.end.column=this._textBuffer.getColumns(b.end.line)):b.end.column=0));this._undoService.begin();this._undoService.add(new d.TextUndoUnit(this,this._textBuffer,b,""));this._undoService.commit()}else this.insertText("")};b.prototype.getTextRange=
function(){if(this.isCursor()){var a=this._textRange.start.line,b=this._textRange.start.column;a>=this._textBuffer.getLines()?(a=this._textBuffer.getLines()-1,b=this.getColumns(a)):b>this.getColumns(a)&&(b=this.getColumns(a));return new d.TextRange(new d.TextPosition(a,b),new d.TextPosition(a,b))}a=this._textRange.clone();a.start.line>=this._textBuffer.getLines()&&(a.start.line=this._textBuffer.getLines()-1,a.start.column=this.getColumns(a.start.line));a.end.line>=this._textBuffer.getLines()&&(a.end.line=
this._textBuffer.getLines()-1,a.end.column=this.getColumns(a.end.line));a.start.column>this.getColumns(a.start.line)&&(a.start=new d.TextPosition(a.start.line,this.getColumns(a.start.line)));a.end.column>this.getColumns(a.end.line)&&(a.end=new d.TextPosition(a.end.line,this.getColumns(a.end.line)));return a.normalize()};b.prototype.isCursor=function(){return this._textRange.isEmpty};Object.defineProperty(b.prototype,"tabSize",{get:function(){return this._tabSize},set:function(a){this._tabSize=a;this._tabText=
"";for(a=0;a<this._tabSize;a++)this._tabText+=" "},enumerable:!0,configurable:!0});b.prototype.getColumns=function(a){return this.getTabLength(this._textBuffer.getLine(a))};b.prototype.getTabLength=function(a){for(var b=0,d=a.length,f=0;f<d;f++)b+="\t"===a[f]?this._tabSize:1;return b};b.prototype.toScreenPosition=function(a){var b=this._textBuffer.getLine(a.line).substring(0,a.column),b=this.getTabLength(b)-b.length;return new d.TextPosition(a.line,a.column+b)};b.prototype.toBufferPosition=function(a){for(var b=
this._textBuffer.getLine(a.line),f=0,g=0;g<b.length;g++)if(f+="\t"===b[g]?this._tabSize:1,f>a.column)return new d.TextPosition(a.line,g);return new d.TextPosition(a.line,b.length)};b.prototype.toScreenRange=function(a){return new d.TextRange(this.toScreenPosition(a.start),this.toScreenPosition(a.end))};b.prototype.toBufferRange=function(a){return new d.TextRange(this.toBufferPosition(a.start),this.toBufferPosition(a.end))};b.prototype.getIndent=function(){var a=this.getTextRange();if(a.isEmpty){for(var b=
this._textBuffer.getLine(a.end.line),d=0;d<b.length&&("\t"==b[d]||" "==b[d]);)d++;b=b.substring(0,d);if(a.end.column>=this.getTabLength(b))return b}return""};b.prototype.findWordBreak=function(a,b,d){0>d&&(b+=d);for(var f=this.isWordSeparator(a[b]);0<=b&&b<a.length;b+=d)if(this.isWordSeparator(a[b])!=f)return 0>d?b-d:b;return 0>d?0:a.length};b.prototype.isWordSeparator=function(a){return-1!==" \t'\",;.!~@#$%^&*?=<>()[]:\\+-".indexOf(a)};b.prototype.onSelectionChanged=function(a){for(var b=0;b<this._selectionChangedHandlers.length;b++)this._selectionChangedHandlers[b](a)};
return b}();d.TextModel=f})(Textor||(Textor={}));(function(d){var f=function(){function b(a,b){this.line=a;this.column=b}b.prototype.equals=function(a){return this.line===a.line&&this.column===a.column};b.prototype.compareTo=function(a){var b=this.line-a.line;return 0===b?this.column-a.column:b};b.prototype.clone=function(){return new b(this.line,this.column)};b.prototype.toString=function(){return"("+this.line+","+this.column+")"};return b}();d.TextPosition=f})(Textor||(Textor={}));
(function(d){var f=function(){function b(a,b){this.start=a;this.end=b}Object.defineProperty(b.prototype,"isEmpty",{get:function(){return this.start.line===this.end.line&&this.start.column===this.end.column},enumerable:!0,configurable:!0});b.prototype.normalize=function(){return 0<this.start.compareTo(this.end)?new b(this.end.clone(),this.start.clone()):this.clone()};b.prototype.clone=function(){return new b(this.start.clone(),this.end.clone())};b.prototype.toString=function(){return this.start.toString()+
"-"+this.end.toString()};return b}();d.TextRange=f})(Textor||(Textor={}));
(function(d){var f=function(){function b(a){this._textPosition=new d.TextPosition(0,0);this._textBuffer=a;this.save()}Object.defineProperty(b.prototype,"textPosition",{get:function(){return this._textPosition},enumerable:!0,configurable:!0});b.prototype.peek=function(){if(this._textPosition.line<this._textBuffer.getLines()){var a=this._textBuffer.getLine(this._textPosition.line);return this._textPosition.column>=a.length?"\n":a[this._textPosition.column]}return""};b.prototype.read=function(){if(this._textPosition.line<
this._textBuffer.getLines()){var a=this._textBuffer.getLine(this._textPosition.line),b=this._textPosition.column>=a.length?"\n":a[this._textPosition.column];this._textPosition.column++;this._textPosition.column>a.length&&(this._textPosition.column=0,this._textPosition.line++);return b}return""};b.prototype.match=function(a){for(var b=this._textPosition.line,d=this._textPosition.column,f=0;f<a.length;){var e=this.read();if(0===e.length||e!==a[f])return this._textPosition.line=b,this._textPosition.column=
d,!1;f++}return!0};b.prototype.skipWhitespaces=function(){for(var a,b=!1;0<(a=this.peek()).length&&this.isWhitespace(a);)this.read(),b=!0;return b};b.prototype.skipLineTerminators=function(){for(var a,b=!1;0<(a=this.peek()).length;)if("\n"===a)this.read(),"\r"===this.peek()&&this.read(),b=!0;else if("\r"===a||"\u2028"===a||"\u2029"===a)this.read(),b=!0;else break;return b};b.prototype.save=function(){this._lastLine=this._textPosition.line;this._lastColumn=this._textPosition.column};b.prototype.restore=
function(){this._textPosition.line=this._lastLine;this._textPosition.column=this._lastColumn};b.prototype.isWhitespace=function(a){return" "===a||"\t"===a||"\u00a0"===a};return b}();d.TextReader=f})(Textor||(Textor={}));
(function(d){var f=function(){function b(a,b,d,f){this._undoRange=this._redoSelection=null;this._textModel=a;this._textBuffer=b;this._redoRange=d;this._redoText=f;this._undoText=b.getText(d);this._undoSelection=a.getTextRange()}b.prototype.undo=function(){this._textBuffer.setText(this._undoRange,this._undoText);this._textModel.selectRange(this._undoSelection)};b.prototype.redo=function(){this._undoRange=this._textBuffer.setText(this._redoRange,this._redoText);if(null===this._redoSelection){var a=
this._textModel.toScreenPosition(this._undoRange.end);this._redoSelection=new d.TextRange(a.clone(),a.clone())}this._textModel.selectRange(this._redoSelection)};Object.defineProperty(b.prototype,"isEmpty",{get:function(){return!1},enumerable:!0,configurable:!0});b.prototype.merge=function(a){return a instanceof d.SelectionUndoUnit?(this._redoSelection=a.redoTextRange,!0):!1};b.prototype.toString=function(){return"Text: "+this._undoRange.toString()+" => "+this._redoRange.toString()+" | '"+this._undoText.replace(/\t/g,
"\\t")+"' => '"+this._redoText.replace(/\t/g,"\\t")+"' | "+this._undoSelection.toString()+" => "+this._redoSelection.toString()};return b}();d.TextUndoUnit=f})(Textor||(Textor={}));
(function(d){var f=function(){function b(){this._container=null;this._stack=[];this._position=0}b.prototype.begin=function(){this._container=new d.ContainerUndoUnit};b.prototype.cancel=function(){this._container=null};b.prototype.commit=function(){if(!this._container.isEmpty){this._stack.splice(this._position,this._stack.length-this._position);this._stack.push(this._container);this.redo();for(var a=this._stack[this._stack.length-1],b=a.undoUnits.length-1;0<b&&a.undoUnits[b-1].merge(a.undoUnits[b]);b--)a.undoUnits.splice(b,
1);1<this._stack.length&&(b=this._stack[this._stack.length-2],1===a.undoUnits.length&&0<b.undoUnits.length&&b.undoUnits[b.undoUnits.length-1].merge(a.undoUnits[0])&&(this._stack.splice(this._stack.length-1,1),this._position--))}this._container=null};b.prototype.add=function(a){this._container.add(a)};b.prototype.clear=function(){this._stack=[];this._position=0};b.prototype.undo=function(){0!==this._position&&(this._position--,this._stack[this._position].undo())};b.prototype.redo=function(){0!==this._stack.length&&
this._position<this._stack.length&&(this._stack[this._position].redo(),this._position++)};b.prototype.toString=function(){for(var a="",b=0;b<this._stack.length;b++)a+=this._stack[b].toString();return a};return b}();d.UndoService=f})(Textor||(Textor={}));
